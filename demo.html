<script>
    var fs = require('fs');

    var buildFile = function(name, value) {
        var img = new Buffer(value, 'base64');
        fs.writeFile(name, img, function(err) {
            if(err) {
                console.log(err);
            } else {
                console.log("The file was saved!");
            }
        });
    }

    function wait() {
        $('#close-popup').click();
        setTimeout(function() {screen_shot()}, 10);
    }

    function screen_shot() {
        html2canvas($('body'), {
          onrendered: function(canvas) {
              var img = canvas.toDataURL("image/png").split(',')[1];
              var decodedImg = window.atob(img);
              query_for_save_path(function (save_path) {
                buildFile(save_path, img);
                alert('Screenshot saved to: ' + save_path);
              });
          }
        });
    }

    function query_for_save_path(cb) {
      $('#dialog').show();
      $('#dialog input').one('change', function (event) {
        cb($(this).val());
      });
    }
</script>

<a href="#" onclick="wait();" data-role="button" data-theme="j">Screen shot</a>

<div id="dialog" style="display:none;">
  Choose a path to save your shot:
  <input type="file" nwsaveas />
</div>